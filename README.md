# py_moex
Библиотека(бета) для интеграции с ISS MOEX

Эта библиотека предназначена для удобной работы с ISS MOEX (Информационно-статистической системой Московской биржи). Она позволяет получать биржевые данные с MOEX напрямую из Python-приложений.

### Возможности
- Доступ к реальным данным: Получение котировок и торговой статистики в режиме реального времени (задержка ~15 минут).
- Исторические данные: Загрузка и сохранение исторических данных для анализа программой TSLab.
- Формирование списка активов торгующихся на бирже.

### Установка

Для начала работы с библиотекой достаточно скопировать файл **py_moex.py** в ваш проект.

### Зависимости

Убедитесь, что у вас установлены следующие библиотеки: **requests**, **pandas**

Для их установки используйте команду:

```bash 
pip install requests pandas
```
После этого можно использовать функции из файла **py_moex.py** в вашем проекте.

### Примеры использования

Получения списка бумаг:

```python
shares = get_list_assets("shares")
otc = get_list_assets("otc")
etf = get_list_assets("etf")
futures = get_list_assets("futures")

print(shares, otc, etf, futures)
```

Получение последней цены по бумаге:

```python
ticker = "LKOH"
last_price = get_last_price(ticker)

print(last_price)
```

Получения свечей за период (по умолчанию минутный интервал):
```python
from datetime import datetime, timedelta

start_date = datetime.now() - timedelta(days=5)
end_date = datetime.now()
candles = get_candles("LKOH", start_date, end_date)

print(candles)
```

В папке **Examplse** представлены следующие примеры использования:

- **SaveCandlesFromTslab.py** - сохранение исторических данных в формает читаемом программой TSLab

|TICKER|PER|DATE|TIME|OPEN|HIGH|LOW|CLOSE|VOL|
|------|---|----|----|----|----|---|-----|---|      
SGZH|1|241105|100000|1.729|1.735|1.726|1.731|1754200|
SGZH|1|241105|100100|1.732|1.737|1.724|1.731|4705000|
SGZH|1|241105|100200|1.733|1.76|1.733|1.746|8090100|
SGZH|1|241105|100300|1.748|1.768|1.746|1.758|8610500|

Чтобы запустить файлы примеров необходимо сохранить весь проект целиком.
